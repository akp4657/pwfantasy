<div class="leagues-container">
  <div class="page-header">
    <h1>Fantasy Graps Leagues</h1>
    <button mat-raised-button color="primary" (click)="openCreateLeagueModal()">
      Create League
    </button>
  </div>

  <div class="leagues-content">
    <!-- User's Leagues Section -->
    <div class="league-section" *ngIf="userLeagues.length > 0">
      <h2>My Leagues</h2>
      <div class="leagues-grid">
        <mat-card *ngFor="let league of userLeagues" class="league-card">
          <mat-card-header>
            <mat-card-title>{{ league.Name }}</mat-card-title>
            <mat-card-subtitle>
              Owner: {{ league.Owner?.Name || 'Unknown' }}
            </mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <p *ngIf="league.Description">{{ league.Description }}</p>
            <div class="league-info">
              <span class="info-item">
                <strong>Members:</strong> {{ league.League_Members?.length || 0 }}/{{ league.Max_Members }}
              </span>
              <span class="info-item">
                <strong>Status:</strong> {{ getLeagueStatus(league) }}
              </span>
              <span class="info-item">
                <strong>Draft:</strong> {{ league.Draft_Day | date:'shortDate' }}
              </span>
            </div>
          </mat-card-content>
          
          <mat-card-actions>
            <button mat-button color="primary" [routerLink]="['/league', league._id]">
              View League
            </button>
            <button mat-button color="warn" (click)="leaveLeague(league)" 
                    *ngIf="!isOwner(league)">
              Leave League
            </button>
            <button mat-raised-button color="accent" (click)="startDraft(league)"
                    *ngIf="canStartDraft(league)">
              Start Draft
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>

    <!-- Public Leagues Section -->
    <div class="league-section">
      <h2>Public Leagues</h2>
      <div class="leagues-grid" *ngIf="!loading; else loadingSpinner">
        <mat-card *ngFor="let league of publicLeagues" class="league-card">
          <mat-card-header>
            <mat-card-title>{{ league.Name }}</mat-card-title>
            <mat-card-subtitle>
              Owner: {{ league.Owner?.Name || 'Unknown' }}
            </mat-card-subtitle>
          </mat-card-header>
          
          <mat-card-content>
            <p *ngIf="league.Description">{{ league.Description }}</p>
            <div class="league-info">
              <span class="info-item">
                <strong>Members:</strong> {{ league.League_Members?.length || 0 }}/{{ league.Max_Members }}
              </span>
              <span class="info-item">
                <strong>Status:</strong> {{ getLeagueStatus(league) }}
              </span>
              <span class="info-item">
                <strong>Draft:</strong> {{ league.Draft_Day | date:'shortDate' }}
              </span>
            </div>
          </mat-card-content>
          
          <mat-card-actions>
            <button mat-button color="primary" [routerLink]="['/league', league._id]">
              View League
            </button>
            <button mat-raised-button color="primary" (click)="joinLeague(league)"
                    *ngIf="league.League_Members?.length < league.Max_Members">
              Join League
            </button>
            <button mat-button disabled *ngIf="league.League_Members?.length >= league.Max_Members">
              League Full
            </button>
          </mat-card-actions>
        </mat-card>
      </div>
    </div>

    <!-- Error Message -->
    <div class="error-message" *ngIf="error">
      {{ error }}
    </div>

    <!-- Loading Spinner -->
    <ng-template #loadingSpinner>
      <div class="loading-container">
        <mat-spinner diameter="50"></mat-spinner>
        <p>Loading leagues...</p>
      </div>
    </ng-template>
  </div>
</div>
